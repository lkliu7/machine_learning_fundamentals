(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     20007,        584]
NotebookOptionsPosition[     19172,        565]
NotebookOutlinePosition[     19567,        581]
CellTagsIndexPosition[     19524,        578]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"mnist", "=", 
   RowBox[{"ResourceData", "[", 
    RowBox[{"\"\<MNIST\>\"", ",", "\"\<TrainingData\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mnistTest", "=", 
   RowBox[{"ResourceData", "[", 
    RowBox[{"\"\<MNIST\>\"", ",", "\"\<TestData\>\""}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"group", "[", "i_", "]"}], ":=", 
  RowBox[{
   RowBox[{"group", "[", "i", "]"}], "=", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"mnist", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "==", "i"}], "&"}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trainSize", "[", "i_", "]"}], ":=", 
  RowBox[{
   RowBox[{"trainSize", "[", "i", "]"}], "=", 
   RowBox[{"Length", "[", 
    RowBox[{"group", "[", "i", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"groupTest", "[", "i_", "]"}], ":=", 
  RowBox[{
   RowBox[{"groupTest", "[", "i", "]"}], "=", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"mnistTest", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "==", "i"}], "&"}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testSize", "[", "i_", "]"}], ":=", 
  RowBox[{
   RowBox[{"testSize", "[", "i", "]"}], "=", 
   RowBox[{"Length", "[", 
    RowBox[{"groupTest", "[", "i", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vec", "[", "img_", "]"}], ":=", 
  RowBox[{"1", "-", 
   RowBox[{"Flatten", "[", 
    RowBox[{"ImageData", "[", "img", "]"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.9750268793331203`*^9, 3.9750269215800047`*^9}, 
   3.976100003828727*^9, {3.976100034640066*^9, 3.976100060391409*^9}, 
   3.976100661069633*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"7582e87b-3193-4809-b87a-7c5a80d9b458"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"vec", "/@", 
    RowBox[{"mnist", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"labels", "=", 
   RowBox[{"mnist", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "2"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testData", "=", 
   RowBox[{"vec", "/@", 
    RowBox[{"mnistTest", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testLabels", "=", 
   RowBox[{"mnistTest", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "2"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nTest", "=", 
   RowBox[{"Length", "[", "testLabels", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"classes", "=", 
   RowBox[{"DeleteDuplicates", "[", "labels", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nClasses", "=", 
   RowBox[{"Length", "[", "classes", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pos", "=", 
   RowBox[{"AssociationThread", "[", 
    RowBox[{"classes", "->", 
     RowBox[{"Range", "[", "nClasses", "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.976100598959671*^9, 3.976100620354196*^9}, {
   3.976100950457341*^9, 3.976100956921783*^9}, {3.976101075995407*^9, 
   3.976101109167481*^9}, {3.9761013662430887`*^9, 3.97610140233617*^9}, {
   3.9761056183741293`*^9, 3.97610562880655*^9}, {3.976105662871686*^9, 
   3.976105670539914*^9}, 
   3.976123547629385*^9},ExpressionUUID->"f8edc708-2ea0-45fa-832a-\
9cf23ce0eed8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dist", "[", "vec_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"z", ",", "a"}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"z", "[", "0", "]"}], "=", "vec"}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"a", "[", "j", "]"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"W", "[", "j", "]"}], ".", 
           RowBox[{"z", "[", 
            RowBox[{"j", "-", "1"}], "]"}]}], "+", 
          RowBox[{"b", "[", "j", "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"z", "[", "j", "]"}], "=", 
         RowBox[{"Ramp", "[", 
          RowBox[{"a", "[", "j", "]"}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "L"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"L", "+", "1"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"W", "[", 
         RowBox[{"L", "+", "1"}], "]"}], ".", 
        RowBox[{"z", "[", "L", "]"}]}], "+", 
       RowBox[{"b", "[", 
        RowBox[{"L", "+", "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{"a", "[", 
        RowBox[{"L", "+", "1"}], "]"}], "]"}], "/", 
      RowBox[{"Total", "[", 
       RowBox[{"Exp", "[", 
        RowBox[{"a", "[", 
         RowBox[{"L", "+", "1"}], "]"}], "]"}], "]"}]}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pred", "[", "vec_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"y", "=", 
      RowBox[{"dist", "[", "vec", "]"}]}], "}"}], ",", 
    RowBox[{"classes", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"FirstPosition", "[", 
        RowBox[{"y", ",", 
         RowBox[{"Max", "[", "y", "]"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.9761053700872517`*^9, 3.9761054096527243`*^9}, {
  3.9761054406957407`*^9, 3.97610545476455*^9}, {3.9761069833219967`*^9, 
  3.976106985235318*^9}, {3.976107968207427*^9, 3.976107994237143*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"53f189df-149b-4371-9b43-6cbc2dd93d47"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"epochs", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lr", "=", 
   SuperscriptBox["10", 
    RowBox[{"-", "1"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initRange", "=", 
   RowBox[{"1", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"n", ",", "d0"}], "}"}], "=", 
   RowBox[{"Dimensions", "[", "data", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hiddenDims", "=", 
   RowBox[{"{", 
    RowBox[{"256", ",", "256"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L", "=", 
   RowBox[{"Length", "[", "hiddenDims", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"W", "[", "1", "]"}], "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"hiddenDims", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "d0"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"b", "[", "1", "]"}], "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"hiddenDims", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"W", "[", "l", "]"}], "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"hiddenDims", "[", 
           RowBox[{"[", "l", "]"}], "]"}], ",", 
          RowBox[{"hiddenDims", "[", 
           RowBox[{"[", 
            RowBox[{"l", "-", "1"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"b", "[", "l", "]"}], "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"hiddenDims", "[", 
         RowBox[{"[", "l", "]"}], "]"}]}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"l", ",", "2", ",", "L"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"W", "[", 
    RowBox[{"L", "+", "1"}], "]"}], "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nClasses", ",", 
       RowBox[{"hiddenDims", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"b", "[", 
    RowBox[{"L", "+", "1"}], "]"}], "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "nClasses"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"W", "[", "l", "]"}], "=", 
      RowBox[{"initRange", " ", 
       RowBox[{"W", "[", "l", "]"}]}]}], ";", 
     RowBox[{
      RowBox[{"b", "[", "l", "]"}], "=", 
      RowBox[{"initRange", " ", 
       RowBox[{"b", "[", "l", "]"}]}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"l", ",", 
      RowBox[{"L", "+", "1"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trainPreds", "=", 
   RowBox[{"pred", "/@", "data"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"matches", "=", 
   RowBox[{"MapThread", "[", 
    RowBox[{"Equal", ",", 
     RowBox[{"{", 
      RowBox[{"trainPreds", ",", "labels"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"acc", "[", "0", "]"}], "=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"Count", "[", 
      RowBox[{"matches", ",", "True"}], "]"}], "/", "n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testPreds", "=", 
   RowBox[{"pred", "/@", "testData"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"testMatches", "=", 
   RowBox[{"MapThread", "[", 
    RowBox[{"Equal", ",", 
     RowBox[{"{", 
      RowBox[{"testPreds", ",", "testLabels"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"accTest", "[", "0", "]"}], "=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"Count", "[", 
      RowBox[{"testMatches", ",", "True"}], "]"}], "/", "nTest"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.976122423044201*^9, 3.976122427232851*^9}, {
   3.976122714865024*^9, 3.97612271639498*^9}, {3.97612352518146*^9, 
   3.976123525559083*^9}, 3.9761238093780727`*^9},
 CellLabel->"In[88]:=",ExpressionUUID->"2f2bad0a-14b6-4a5e-abb0-2d0be0a847ba"],

Cell[BoxData[
 RowBox[{"Monitor", "[", 
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"batch", "=", "data"}], ";", "\[IndentingNewLine]", 
      RowBox[{"rVec", "=", 
       RowBox[{"pos", "/@", "labels"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Z", "[", "0", "]"}], "=", 
       RowBox[{"Transpose", "[", "batch", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "j", "]"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"W", "[", "j", "]"}], ".", 
            RowBox[{"Z", "[", 
             RowBox[{"j", "-", "1"}], "]"}]}], "+", 
           RowBox[{"b", "[", "j", "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Z", "[", "j", "]"}], "=", 
          RowBox[{"Ramp", "[", 
           RowBox[{"A", "[", "j", "]"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "L"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"L", "+", "1"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"W", "[", 
          RowBox[{"L", "+", "1"}], "]"}], ".", 
         RowBox[{"Z", "[", "L", "]"}]}], "+", 
        RowBox[{"b", "[", 
         RowBox[{"L", "+", "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Y", "=", 
       RowBox[{"Exp", "[", 
        RowBox[{"Transpose", "[", 
         RowBox[{"A", "[", 
          RowBox[{"L", "+", "1"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Y", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "/", 
          RowBox[{"Total", "[", "#", "]"}]}], "&"}], "/@", "Y"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"e", "[", 
        RowBox[{"L", "+", "1"}], "]"}], "=", 
       RowBox[{"Y", "-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"UnitVector", "[", 
            RowBox[{"nClasses", ",", "#"}], "]"}], "&"}], "/@", "rVec"}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"e", "[", "j", "]"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"e", "[", 
            RowBox[{"j", "+", "1"}], "]"}], ".", 
           RowBox[{"W", "[", 
            RowBox[{"j", "+", "1"}], "]"}]}], 
          RowBox[{"Transpose", "[", 
           RowBox[{"UnitStep", "[", 
            RowBox[{
             RowBox[{"Z", "[", "j", "]"}], "-", "$MachineEpsilon"}], "]"}], 
           "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "L", ",", "1", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"gradQW", "[", "j", "]"}], "=", 
          RowBox[{"Transpose", "[", 
           RowBox[{
            RowBox[{"Z", "[", 
             RowBox[{"j", "-", "1"}], "]"}], ".", 
            RowBox[{"e", "[", "j", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"gradQb", "[", "j", "]"}], "=", 
          RowBox[{"Total", "[", 
           RowBox[{"e", "[", "j", "]"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"L", "+", "1"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"loss", "[", 
        RowBox[{"m", "-", "1"}], "]"}], "=", 
       RowBox[{"-", 
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Log", "[", "Y", "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"UnitVector", "[", 
               RowBox[{"nClasses", ",", "#"}], "]"}], "&"}], "/@", "rVec"}], 
            ")"}]}], ",", "2"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"loss", "[", 
        RowBox[{"m", "-", "1"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"W", "[", "j", "]"}], "-=", 
          RowBox[{"lr", " ", 
           RowBox[{
            RowBox[{"gradQW", "[", "j", "]"}], "/", "n"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"b", "[", "j", "]"}], "-=", 
          RowBox[{"lr", " ", 
           RowBox[{
            RowBox[{"gradQb", "[", "j", "]"}], "/", "n"}]}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"L", "+", "1"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"trainPreds", "=", 
       RowBox[{"pred", "/@", "data"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"matches", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Equal", ",", 
         RowBox[{"{", 
          RowBox[{"trainPreds", ",", "labels"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"acc", "[", "m", "]"}], "=", 
       RowBox[{"N", "[", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"matches", ",", "True"}], "]"}], "/", "n"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"testPreds", "=", 
       RowBox[{"pred", "/@", "testData"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"testMatches", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Equal", ",", 
         RowBox[{"{", 
          RowBox[{"testPreds", ",", "testLabels"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"accTest", "[", "m", "]"}], "=", 
       RowBox[{"N", "[", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"testMatches", ",", "True"}], "]"}], "/", "nTest"}], 
        "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "epochs"}], "}"}]}], "]"}], ",", "m"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.976121641324925*^9, 3.976121652785035*^9}, {
   3.976121806735635*^9, 3.976121806859136*^9}, 3.97612186831557*^9, {
   3.976121900898151*^9, 3.976121922683161*^9}, {3.976121995021845*^9, 
   3.976122003679858*^9}, {3.976122129905932*^9, 3.976122134012856*^9}, {
   3.976122401259468*^9, 3.976122416120273*^9}, {3.976122696799718*^9, 
   3.976122698364935*^9}, {3.9761272988152018`*^9, 3.9761273056307993`*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"a78994e8-1273-4d76-8159-472c84456517"],

Cell[BoxData[{
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i", ",", 
     RowBox[{"acc", "[", "i", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "0", ",", "epochs"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i", ",", 
     RowBox[{"accTest", "[", "i", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "0", ",", "epochs"}], "}"}]}], "]"}], "\n", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"acc", "[", "i", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", "epochs"}], "}"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"accTest", "[", "i", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", "epochs"}], "}"}]}], "]"}]}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ListLogPlot", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"loss", "[", "i", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "epochs"}], "}"}]}], "]"}], "]"}]}], "Input",\

 CellChangeTimes->{{3.97611905256883*^9, 3.976119058247941*^9}, {
   3.976119103864655*^9, 3.976119106405471*^9}, 3.976122064502286*^9},
 CellLabel->
  "In[107]:=",ExpressionUUID->"45797b3d-97b3-4f8a-9e78-e1e355282081"]
},
WindowSize->{1366, 893},
WindowMargins->{{Automatic, -1366}, {0, Automatic}},
FrontEndVersion->"14.3 for Mac OS X ARM (64-bit) (July 8, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"27f191f3-5dc2-4c70-af6b-a5a334802dbc"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 2001, 56, 151, "Input",ExpressionUUID->"7582e87b-3193-4809-b87a-7c5a80d9b458"],
Cell[2558, 78, 1654, 45, 172, "Input",ExpressionUUID->"f8edc708-2ea0-45fa-832a-9cf23ce0eed8"],
Cell[4215, 125, 2233, 62, 111, "Input",ExpressionUUID->"53f189df-149b-4371-9b43-6cbc2dd93d47"],
Cell[6451, 189, 4791, 150, 397, "Input",ExpressionUUID->"2f2bad0a-14b6-4a5e-abb0-2d0be0a847ba"],
Cell[11245, 341, 6395, 174, 458, "Input",ExpressionUUID->"a78994e8-1273-4d76-8159-472c84456517"],
Cell[17643, 517, 1525, 46, 111, "Input",ExpressionUUID->"45797b3d-97b3-4f8a-9e78-e1e355282081"]
}
]
*)

