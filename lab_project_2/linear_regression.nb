(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     20314,        568]
NotebookOptionsPosition[     19206,        546]
NotebookOutlinePosition[     19597,        562]
CellTagsIndexPosition[     19554,        559]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"mnist", "=", 
   RowBox[{"ResourceData", "[", 
    RowBox[{"\"\<MNIST\>\"", ",", "\"\<TrainingData\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mnistTest", "=", 
   RowBox[{"ResourceData", "[", 
    RowBox[{"\"\<MNIST\>\"", ",", "\"\<TestData\>\""}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"group", "[", "i_", "]"}], ":=", 
  RowBox[{
   RowBox[{"group", "[", "i", "]"}], "=", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"mnist", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "==", "i"}], "&"}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trainSize", "[", "i_", "]"}], ":=", 
  RowBox[{
   RowBox[{"trainSize", "[", "i", "]"}], "=", 
   RowBox[{"Length", "[", 
    RowBox[{"group", "[", "i", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"groupTest", "[", "i_", "]"}], ":=", 
  RowBox[{
   RowBox[{"groupTest", "[", "i", "]"}], "=", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"mnistTest", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "==", "i"}], "&"}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testSize", "[", "i_", "]"}], ":=", 
  RowBox[{
   RowBox[{"testSize", "[", "i", "]"}], "=", 
   RowBox[{"Length", "[", 
    RowBox[{"groupTest", "[", "i", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nums", "=", 
   RowBox[{"{", 
    RowBox[{"5", ",", "8"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Join", "@@", 
    RowBox[{"group", "/@", "nums"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"n", "=", 
   RowBox[{"Total", "[", 
    RowBox[{"trainSize", "/@", "nums"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vec", "[", "img_", "]"}], ":=", 
  RowBox[{"1", "-", 
   RowBox[{"Flatten", "[", 
    RowBox[{"ImageData", "[", "img", "]"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.9750268793331203`*^9, 3.9750269215800047`*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"1b4fb35c-3ad6-4c60-a91f-6f68e175a58a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{"vec", "/@", "data"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"ConstantArray", "[", 
      RowBox[{"1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"group", "[", 
         RowBox[{"nums", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"Length", "[", 
        RowBox[{"group", "[", 
         RowBox[{"nums", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9738675230931883`*^9, 3.97386762632299*^9}, {
  3.973867664622758*^9, 3.973867667210335*^9}, {3.974234813790915*^9, 
  3.9742348138957853`*^9}, {3.974236041662706*^9, 3.9742360418268557`*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"6b7e91d6-7b72-4324-9625-899031cbb078"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"shift", "=", 
   SuperscriptBox["10", 
    RowBox[{"-", "2"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wExact", "=", 
   RowBox[{
    RowBox[{"Inverse", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Transpose", "[", "X", "]"}], ".", "X"}], "+", 
      RowBox[{"shift", " ", 
       RowBox[{"IdentityMatrix", "[", "784", "]"}]}]}], "]"}], ".", 
    RowBox[{"Transpose", "[", "X", "]"}], ".", "y"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.973867639759796*^9, 3.973867661939082*^9}, {
   3.973867792534479*^9, 3.973867838156968*^9}, {3.97386803773096*^9, 
   3.973868048955782*^9}, {3.974234978389842*^9, 3.974234984578663*^9}, {
   3.974379566455235*^9, 3.974379567669899*^9}, 3.974380026583026*^9, {
   3.974380390813004*^9, 3.97438039275791*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"59ed4e72-5f21-4a23-bb95-ef0bab3e6d1d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"yX", "=", 
   RowBox[{"y", ".", "X"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XTX", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", "X", "]"}], ".", "X"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"error", "[", "w_", "]"}], ":=", 
  SuperscriptBox[
   RowBox[{"Norm", "[", 
    RowBox[{
     RowBox[{"X", ".", "w"}], "-", "y"}], "]"}], "2"]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"grad", "[", "w_", "]"}], ":=", 
  RowBox[{"2", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"XTX", ".", "w"}], "-", "yX"}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.974379241927944*^9, 3.974379295852202*^9}, {
   3.9743793580256844`*^9, 3.9743793739926147`*^9}, {3.974379430104033*^9, 
   3.97437945263422*^9}, 3.9743795307416983`*^9, {3.9743813739124804`*^9, 
   3.974381390714899*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"8516f467-b0a2-400a-8fdd-233779cde844"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lr", "=", 
   RowBox[{"1", " ", 
    SuperscriptBox["10", 
     RowBox[{"-", "6"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iters", "=", "100000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", "784"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tol", "=", 
   SuperscriptBox["10", 
    RowBox[{"-", "6"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"0", ",", "\"\< \>\"", ",", 
   RowBox[{"prevError", "=", 
    RowBox[{"error", "[", "w", "]"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"w", "-=", 
      RowBox[{"lr", " ", 
       RowBox[{"grad", "[", "w", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"currentError", "=", 
      RowBox[{"error", "[", "w", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"i", ",", "100"}], "]"}], "==", "0"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{"i", ",", "\"\< \>\"", ",", "currentError"}], "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"prevError", "/", "currentError"}], "-", "1"}], "]"}], "<", 
        "tol"}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<converged at iteration \>\"", ",", " ", "i"}], "]"}], ";", 
        RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"prevError", "=", "currentError"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "iters"}], "}"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.974379405452724*^9, 3.974379407813608*^9}, {
   3.974379449932362*^9, 3.974379460166787*^9}, 3.974379555108316*^9, {
   3.974379657961217*^9, 3.9743796902112207`*^9}, {3.97438004421542*^9, 
   3.974380078389139*^9}, 3.9743804217406673`*^9, {3.974380695559587*^9, 
   3.9743807233226*^9}, 3.974562969381998*^9, {3.975034517403051*^9, 
   3.975034517504919*^9}, {3.975082359654324*^9, 
   3.9750823604838133`*^9}},ExpressionUUID->"eac33fbc-8a26-4c67-aed2-\
c5d192848673"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"batchSize", "=", "64"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"batchGrad", "[", 
   RowBox[{"w_", ",", "vecs_", ",", "labels_"}], "]"}], ":=", 
  RowBox[{"2", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"vecs", ".", "w", ".", "vecs"}], "-", 
     RowBox[{"labels", ".", "vecs"}]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"batchSGD", "[", 
   RowBox[{"batchSize_", ",", "lr_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"batches", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"RandomSample", "[", 
         RowBox[{"Range", "[", "n", "]"}], "]"}], ",", "batchSize"}], "]"}]}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{"wSGD", "-=", 
       RowBox[{"lr", " ", 
        RowBox[{"batchGrad", "[", 
         RowBox[{"wSGD", ",", 
          RowBox[{"X", "[", 
           RowBox[{"[", "batch", "]"}], "]"}], ",", 
          RowBox[{"y", "[", 
           RowBox[{"[", "batch", "]"}], "]"}]}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"batch", ",", "batches"}], "}"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lr", "=", 
   RowBox[{"1", " ", 
    SuperscriptBox["10", 
     RowBox[{"-", "5"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iters", "=", "100000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wSGD", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", "784"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tol", "=", 
   SuperscriptBox["10", 
    RowBox[{"-", "6"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"0", ",", "\"\< \>\"", ",", 
   RowBox[{"prevError", "=", 
    RowBox[{"error", "[", "wSGD", "]"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"batchSGD", "[", 
      RowBox[{"batchSize", ",", "lr"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"currentError", "=", 
      RowBox[{"error", "[", "wSGD", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"i", ",", "100"}], "]"}], "==", "0"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{"i", ",", "\"\< \>\"", ",", "currentError"}], "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"prevError", "/", "currentError"}], "-", "1"}], "]"}], "<", 
        "tol"}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<converged at iteration \>\"", ",", " ", "i"}], "]"}], ";", 
        RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"prevError", "=", "currentError"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "iters"}], "}"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.975025560782213*^9, 3.975025567738925*^9}, {
   3.975026453014707*^9, 3.975026470896962*^9}, {3.975026636043984*^9, 
   3.975026687268099*^9}, {3.975026797581902*^9, 3.9750268634621353`*^9}, {
   3.975026959809505*^9, 3.97502709403238*^9}, {3.9750271363298187`*^9, 
   3.975027176109439*^9}, {3.975027241601882*^9, 3.9750272682133408`*^9}, {
   3.975027431133822*^9, 3.97502743350065*^9}, {3.975027527088593*^9, 
   3.9750275457463913`*^9}, {3.975027647002021*^9, 3.975027647289179*^9}, {
   3.97502806039452*^9, 3.975028061799308*^9}, {3.97502899916996*^9, 
   3.975028999378068*^9}, {3.975029081279071*^9, 3.9750290813494453`*^9}, {
   3.975034536937045*^9, 3.9750345392927923`*^9}, 3.975034763672328*^9, {
   3.9750823663721943`*^9, 
   3.975082367488147*^9}},ExpressionUUID->"24768b70-bed2-4d8a-91bd-\
49fea5bf8d4b"],

Cell[BoxData[{
 RowBox[{"error", "[", "w", "]"}], "\[IndentingNewLine]", 
 RowBox[{"error", "[", "wSGD", "]"}], "\[IndentingNewLine]", 
 RowBox[{"error", "[", "wExact", "]"}]}], "Input",
 CellChangeTimes->{{3.97503477910432*^9, 3.975034788959124*^9}, {
  3.9750823006294403`*^9, 
  3.9750823007887163`*^9}},ExpressionUUID->"c48a6f82-4aef-44c1-a1bf-\
a3177e135b32"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pred", "[", 
   RowBox[{"w_", ",", "x_"}], "]"}], ":=", 
  RowBox[{"Sign", "[", 
   RowBox[{"w", ".", "x"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"predData", "[", 
   RowBox[{"w_", ",", "data_"}], "]"}], ":=", 
  RowBox[{"Sign", "[", 
   RowBox[{"data", ".", "w"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.974563363362176*^9, 3.974563374044137*^9}, {
  3.974563547284823*^9, 3.974563549340042*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"9a6494de-4f84-4020-b591-143e0a69e166"],

Cell[BoxData[{
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Count", "[", 
    RowBox[{
     RowBox[{"predData", "[", 
      RowBox[{"w", ",", 
       RowBox[{"X", "[", 
        RowBox[{"[", 
         RowBox[{";;", 
          RowBox[{"trainSize", "[", 
           RowBox[{"nums", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "]"}]}], "]"}], ",",
      "1"}], "]"}], "/", 
   RowBox[{"trainSize", "[", 
    RowBox[{"nums", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Count", "[", 
    RowBox[{
     RowBox[{"predData", "[", 
      RowBox[{"w", ",", 
       RowBox[{"X", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"trainSize", "[", 
            RowBox[{"nums", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";;"}], "]"}], "]"}]}], 
      "]"}], ",", 
     RowBox[{"-", "1"}]}], "]"}], "/", 
   RowBox[{"trainSize", "[", 
    RowBox[{"nums", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Count", "[", 
    RowBox[{
     RowBox[{"predData", "[", 
      RowBox[{"w", ",", 
       RowBox[{"(", 
        RowBox[{"vec", "/@", 
         RowBox[{"groupTest", "[", 
          RowBox[{"nums", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}]}], "]"}], ",", 
     "1"}], "]"}], "/", 
   RowBox[{"testSize", "[", 
    RowBox[{"nums", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Count", "[", 
    RowBox[{
     RowBox[{"predData", "[", 
      RowBox[{"w", ",", 
       RowBox[{"(", 
        RowBox[{"vec", "/@", 
         RowBox[{"groupTest", "[", 
          RowBox[{"nums", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ")"}]}], "]"}], ",", 
     RowBox[{"-", "1"}]}], "]"}], "/", 
   RowBox[{"testSize", "[", 
    RowBox[{"nums", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Count", "[", 
    RowBox[{
     RowBox[{"predData", "[", 
      RowBox[{"wSGD", ",", 
       RowBox[{"X", "[", 
        RowBox[{"[", 
         RowBox[{";;", 
          RowBox[{"trainSize", "[", 
           RowBox[{"nums", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "]"}]}], "]"}], ",",
      "1"}], "]"}], "/", 
   RowBox[{"trainSize", "[", 
    RowBox[{"nums", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Count", "[", 
    RowBox[{
     RowBox[{"predData", "[", 
      RowBox[{"wSGD", ",", 
       RowBox[{"X", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"trainSize", "[", 
            RowBox[{"nums", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";;"}], "]"}], "]"}]}], 
      "]"}], ",", 
     RowBox[{"-", "1"}]}], "]"}], "/", 
   RowBox[{"trainSize", "[", 
    RowBox[{"nums", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Count", "[", 
    RowBox[{
     RowBox[{"predData", "[", 
      RowBox[{"wSGD", ",", 
       RowBox[{"(", 
        RowBox[{"vec", "/@", 
         RowBox[{"groupTest", "[", 
          RowBox[{"nums", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}]}], "]"}], ",", 
     "1"}], "]"}], "/", 
   RowBox[{"testSize", "[", 
    RowBox[{"nums", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Count", "[", 
    RowBox[{
     RowBox[{"predData", "[", 
      RowBox[{"wSGD", ",", 
       RowBox[{"(", 
        RowBox[{"vec", "/@", 
         RowBox[{"groupTest", "[", 
          RowBox[{"nums", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ")"}]}], "]"}], ",", 
     RowBox[{"-", "1"}]}], "]"}], "/", 
   RowBox[{"testSize", "[", 
    RowBox[{"nums", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Count", "[", 
    RowBox[{
     RowBox[{"predData", "[", 
      RowBox[{"wExact", ",", 
       RowBox[{"X", "[", 
        RowBox[{"[", 
         RowBox[{";;", 
          RowBox[{"trainSize", "[", 
           RowBox[{"nums", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "]"}]}], "]"}], ",",
      "1"}], "]"}], "/", 
   RowBox[{"trainSize", "[", 
    RowBox[{"nums", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Count", "[", 
    RowBox[{
     RowBox[{"predData", "[", 
      RowBox[{"wExact", ",", 
       RowBox[{"X", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"trainSize", "[", 
            RowBox[{"nums", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";;"}], "]"}], "]"}]}], 
      "]"}], ",", 
     RowBox[{"-", "1"}]}], "]"}], "/", 
   RowBox[{"trainSize", "[", 
    RowBox[{"nums", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Count", "[", 
    RowBox[{
     RowBox[{"predData", "[", 
      RowBox[{"wExact", ",", 
       RowBox[{"(", 
        RowBox[{"vec", "/@", 
         RowBox[{"groupTest", "[", 
          RowBox[{"nums", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}]}], "]"}], ",", 
     "1"}], "]"}], "/", 
   RowBox[{"testSize", "[", 
    RowBox[{"nums", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Count", "[", 
    RowBox[{
     RowBox[{"predData", "[", 
      RowBox[{"wExact", ",", 
       RowBox[{"(", 
        RowBox[{"vec", "/@", 
         RowBox[{"groupTest", "[", 
          RowBox[{"nums", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ")"}]}], "]"}], ",", 
     RowBox[{"-", "1"}]}], "]"}], "/", 
   RowBox[{"testSize", "[", 
    RowBox[{"nums", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.973867935088073*^9, 3.973867965274271*^9}, {
   3.973880983897625*^9, 3.97388100934597*^9}, {3.9738810647968884`*^9, 
   3.973881076010865*^9}, 3.9745629748320627`*^9, {3.974563388361539*^9, 
   3.9745634147136*^9}, {3.974563553795766*^9, 3.974563577346405*^9}, {
   3.975027612173382*^9, 3.975027627535253*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"5177cf8a-8198-4234-b7e6-7ccf0557af2f"]
},
WindowSize->{864, 1051},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"14.3 for Mac OS X ARM (64-bit) (July 8, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"8d5e0052-3ce2-442e-804b-fc69b7161557"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 2277, 66, 213, "Input",ExpressionUUID->"1b4fb35c-3ad6-4c60-a91f-6f68e175a58a"],
Cell[2834, 88, 974, 25, 49, "Input",ExpressionUUID->"6b7e91d6-7b72-4324-9625-899031cbb078"],
Cell[3811, 115, 884, 20, 49, "Input",ExpressionUUID->"59ed4e72-5f21-4a23-bb95-ef0bab3e6d1d"],
Cell[4698, 137, 920, 24, 90, "Input",ExpressionUUID->"8516f467-b0a2-400a-8fdd-233779cde844"],
Cell[5621, 163, 2296, 58, 213, "Input",ExpressionUUID->"eac33fbc-8a26-4c67-aed2-c5d192848673"],
Cell[7920, 223, 3825, 96, 294, "Input",ExpressionUUID->"24768b70-bed2-4d8a-91bd-49fea5bf8d4b"],
Cell[11748, 321, 364, 7, 70, "Input",ExpressionUUID->"c48a6f82-4aef-44c1-a1bf-a3177e135b32"],
Cell[12115, 330, 531, 13, 49, "Input",ExpressionUUID->"9a6494de-4f84-4020-b591-143e0a69e166"],
Cell[12649, 345, 6553, 199, 254, "Input",ExpressionUUID->"5177cf8a-8198-4234-b7e6-7ccf0557af2f"]
}
]
*)

(* End of internal cache information *)

