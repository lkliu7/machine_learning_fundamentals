(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     20129,        537]
NotebookOptionsPosition[     19111,        516]
NotebookOutlinePosition[     19502,        532]
CellTagsIndexPosition[     19459,        529]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"mnist", "=", 
   RowBox[{"ResourceData", "[", 
    RowBox[{"\"\<MNIST\>\"", ",", "\"\<TrainingData\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mnistTest", "=", 
   RowBox[{"ResourceData", "[", 
    RowBox[{"\"\<MNIST\>\"", ",", "\"\<TestData\>\""}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"group", "[", "i_", "]"}], ":=", 
  RowBox[{
   RowBox[{"group", "[", "i", "]"}], "=", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"mnist", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "==", "i"}], "&"}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trainSize", "[", "i_", "]"}], ":=", 
  RowBox[{
   RowBox[{"trainSize", "[", "i", "]"}], "=", 
   RowBox[{"Length", "[", 
    RowBox[{"group", "[", "i", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"groupTest", "[", "i_", "]"}], ":=", 
  RowBox[{
   RowBox[{"groupTest", "[", "i", "]"}], "=", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"mnistTest", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "==", "i"}], "&"}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testSize", "[", "i_", "]"}], ":=", 
  RowBox[{
   RowBox[{"testSize", "[", "i", "]"}], "=", 
   RowBox[{"Length", "[", 
    RowBox[{"groupTest", "[", "i", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nums", "=", 
   RowBox[{"{", 
    RowBox[{"5", ",", "8"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Join", "@@", 
    RowBox[{"group", "/@", "nums"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"n", "=", 
   RowBox[{"Total", "[", 
    RowBox[{"trainSize", "/@", "nums"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vec", "[", "img_", "]"}], ":=", 
  RowBox[{"1", "-", 
   RowBox[{"Flatten", "[", 
    RowBox[{"ImageData", "[", "img", "]"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"oneminuslC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"x", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
     RowBox[{"1", "-", 
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", "x"}]]}], ")"}]}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"llC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"x", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
     RowBox[{"Log", "[", 
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", "x"}]]}], ")"}]}], "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.973014402911982*^9, 3.9730144144979067`*^9}, {
   3.9730252040203743`*^9, 3.973025204756147*^9}, 3.973034322253763*^9, {
   3.973867878452237*^9, 3.973867891413102*^9}, {3.9742489818673964`*^9, 
   3.974248998846047*^9}, {3.97425098644695*^9, 3.974251015387321*^9}, 
   3.974251214546698*^9, {3.9742512708290052`*^9, 3.974251292806039*^9}, {
   3.9742523775653563`*^9, 3.974252378607732*^9}, {3.97425242656113*^9, 
   3.974252427010623*^9}, {3.9743845109038897`*^9, 3.974384523216559*^9}, {
   3.974404571281063*^9, 3.9744045804733562`*^9}, {3.9744049863891907`*^9, 
   3.974404994263584*^9}, {3.9744052801854763`*^9, 3.974405286215324*^9}, {
   3.9744056991454573`*^9, 3.974405707724711*^9}, {3.974406066180244*^9, 
   3.974406066403679*^9}, {3.974562610903233*^9, 3.9745626376780787`*^9}, {
   3.974562683455638*^9, 3.974562687188081*^9}, {3.975079792685602*^9, 
   3.975079792818915*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"7468b479-d3ca-48fc-b78b-3516419419b2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{"vec", "/@", "data"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"ConstantArray", "[", 
      RowBox[{"1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"group", "[", 
         RowBox[{"nums", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"Length", "[", 
        RowBox[{"group", "[", 
         RowBox[{"nums", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.974248971832637*^9, 3.974248973740443*^9}, {
  3.974405757193059*^9, 3.974405779545957*^9}, {3.9744059868311977`*^9, 
  3.974405986994808*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"1d4a402a-d9b1-4296-8f4c-ccd3cc8cfc45"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"error", "[", "w_", "]"}], ":=", 
  RowBox[{"-", 
   RowBox[{"Total", "[", 
    RowBox[{"llC", "[", 
     RowBox[{"y", " ", 
      RowBox[{"X", ".", "w"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"grad", "[", "w_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p", "=", 
      RowBox[{"oneminuslC", "[", 
       RowBox[{"y", " ", 
        RowBox[{"X", ".", "w"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"y", " ", "p"}], ")"}], ".", "X"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.974249009834613*^9, 3.974249105455166*^9}, {
   3.974249155372285*^9, 3.974249156290406*^9}, {3.974249275456707*^9, 
   3.974249281923689*^9}, {3.9742499327646847`*^9, 3.974249980833791*^9}, {
   3.9742501173222857`*^9, 3.974250122227528*^9}, {3.974250238606969*^9, 
   3.974250243026784*^9}, {3.974250698598267*^9, 3.974250708967237*^9}, {
   3.974251028200165*^9, 3.974251043342675*^9}, {3.974251085761022*^9, 
   3.974251097680037*^9}, {3.9742512761511374`*^9, 3.974251281211604*^9}, {
   3.974251883996002*^9, 3.974251948973258*^9}, {3.974251983343659*^9, 
   3.974251996965941*^9}, 3.974252169628359*^9, 3.9742523099131107`*^9, 
   3.974384436958954*^9, {3.974384540477957*^9, 3.9743845470462713`*^9}, {
   3.9743845771838503`*^9, 3.974384588916272*^9}, {3.9743848630015182`*^9, 
   3.974384876075283*^9}, 3.974404669811372*^9, {3.9744049541411552`*^9, 
   3.974404960231865*^9}, {3.9744049987343187`*^9, 3.974405000594241*^9}, {
   3.9744052892774982`*^9, 3.974405297032743*^9}, {3.9744058245456247`*^9, 
   3.974405835707409*^9}, {3.974405990579772*^9, 3.97440600454529*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"419b7ae0-6961-4d2c-9dc8-a51793abd9e5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lr", "=", 
   RowBox[{"1", " ", 
    SuperscriptBox["10", 
     RowBox[{"-", "4"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iters", "=", "100000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", "784"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tol", "=", 
   SuperscriptBox["10", 
    RowBox[{"-", "6"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"0", ",", "\"\< \>\"", ",", 
   RowBox[{"prevError", "=", 
    RowBox[{"error", "[", "w", "]"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"w", "-=", 
      RowBox[{"lr", " ", 
       RowBox[{"grad", "[", "w", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"currentError", "=", 
      RowBox[{"error", "[", "w", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"i", ",", "1000"}], "]"}], "==", "0"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{"i", ",", "\"\< \>\"", ",", "currentError"}], "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"prevError", "/", "currentError"}], "-", "1"}], "]"}], "<", 
        "tol"}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<converged at iteration \>\"", ",", " ", "i"}], "]"}], ";", 
        RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"prevError", "=", "currentError"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "iters"}], "}"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.974379405452724*^9, 3.974379407813608*^9}, {
   3.974379449932362*^9, 3.974379460166787*^9}, 3.974379555108316*^9, {
   3.974379657961217*^9, 3.9743796902112207`*^9}, {3.97438004421542*^9, 
   3.974380078389139*^9}, 3.9743804217406673`*^9, {3.974380695559587*^9, 
   3.9743807233226*^9}, {3.974384617364297*^9, 3.974384618410503*^9}, {
   3.974384745374864*^9, 3.974384745523315*^9}, {3.974384841377997*^9, 
   3.974384841685278*^9}, {3.974384894143079*^9, 3.9743848942939367`*^9}, {
   3.9743849570388308`*^9, 3.9743850070221577`*^9}, 3.974404777322191*^9, {
   3.97440513884277*^9, 3.974405144929387*^9}, 3.974405978313704*^9, 
   3.974406052605978*^9, {3.974406784114317*^9, 3.974406790225897*^9}, {
   3.974406842309057*^9, 3.974406844214744*^9}, {3.974475992826703*^9, 
   3.9744760061860657`*^9}, {3.9744774055526752`*^9, 3.974477567532143*^9}, {
   3.974562464476511*^9, 3.974562464617065*^9}, {3.9745628981791763`*^9, 
   3.974562898307769*^9}, {3.975080055887453*^9, 3.9750800575980787`*^9}, 
   3.975080683845676*^9},
 CellLabel->"In[17]:=",ExpressionUUID->"5924cfd9-ccbd-4875-8cdb-548966507efb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"batchSize", "=", "64"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"batchGrad", "[", 
   RowBox[{"w_", ",", "vecs_", ",", "labels_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p", "=", 
      RowBox[{"oneminuslC", "[", 
       RowBox[{"labels", " ", 
        RowBox[{"vecs", ".", "w"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"labels", " ", "p"}], ")"}], ".", "vecs"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"batchSGD", "[", 
   RowBox[{"batchSize_", ",", "lr_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"batches", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"RandomSample", "[", 
         RowBox[{"Range", "[", "n", "]"}], "]"}], ",", "batchSize"}], "]"}]}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{"wSGD", "-=", 
       RowBox[{"lr", " ", 
        RowBox[{"batchGrad", "[", 
         RowBox[{"wSGD", ",", 
          RowBox[{"X", "[", 
           RowBox[{"[", "batch", "]"}], "]"}], ",", 
          RowBox[{"y", "[", 
           RowBox[{"[", "batch", "]"}], "]"}]}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"batch", ",", "batches"}], "}"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lr", "=", 
   RowBox[{"1", " ", 
    SuperscriptBox["10", 
     RowBox[{"-", "4"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iters", "=", "100000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wSGD", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", "784"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tol", "=", 
   SuperscriptBox["10", 
    RowBox[{"-", "6"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"0", ",", "\"\< \>\"", ",", 
   RowBox[{"prevError", "=", 
    RowBox[{"error", "[", "wSGD", "]"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"batchSGD", "[", 
      RowBox[{"batchSize", ",", "lr"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"currentError", "=", 
      RowBox[{"error", "[", "wSGD", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"i", ",", "1000"}], "]"}], "==", "0"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{"i", ",", "\"\< \>\"", ",", "currentError"}], "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"prevError", "/", "currentError"}], "-", "1"}], "]"}], "<", 
        "tol"}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<converged at iteration \>\"", ",", " ", "i"}], "]"}], ";", 
        RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"prevError", "=", "currentError"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "iters"}], "}"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.9750796808100157`*^9, 3.975079775953309*^9}, {
   3.975079810769273*^9, 3.975079810903507*^9}, 3.97508069067695*^9, {
   3.975081188436948*^9, 3.975081212631378*^9}, 3.9750817967687807`*^9, {
   3.97508184970184*^9, 3.975081856657563*^9}, {3.97508217766936*^9, 
   3.9750821793675947`*^9}, {3.975083191742958*^9, 
   3.9750831939788227`*^9}},ExpressionUUID->"e0292fe9-2f6a-40da-81f9-\
797833974b28"],

Cell[BoxData[{
 RowBox[{"error", "[", "w", "]"}], "\[IndentingNewLine]", 
 RowBox[{"error", "[", "wSGD", "]"}]}], "Input",
 CellChangeTimes->{{3.97503477910432*^9, 3.975034788959124*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"057e89cb-f676-4274-b400-91635157bb9c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pred", "[", 
   RowBox[{"w_", ",", "x_"}], "]"}], ":=", 
  RowBox[{"Sign", "[", 
   RowBox[{"w", ".", "x"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"predData", "[", 
   RowBox[{"w_", ",", "data_"}], "]"}], ":=", 
  RowBox[{"Sign", "[", 
   RowBox[{"data", ".", "w"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.974563363362176*^9, 3.974563374044137*^9}, {
  3.974563547284823*^9, 3.974563549340042*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"bb78be62-3a1d-45da-8314-c1aa88996b61"],

Cell[BoxData[{
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Count", "[", 
    RowBox[{
     RowBox[{"predData", "[", 
      RowBox[{"w", ",", 
       RowBox[{"X", "[", 
        RowBox[{"[", 
         RowBox[{";;", 
          RowBox[{"trainSize", "[", 
           RowBox[{"nums", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "]"}]}], "]"}], ",",
      "1"}], "]"}], "/", 
   RowBox[{"trainSize", "[", 
    RowBox[{"nums", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Count", "[", 
    RowBox[{
     RowBox[{"predData", "[", 
      RowBox[{"w", ",", 
       RowBox[{"X", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"trainSize", "[", 
            RowBox[{"nums", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";;"}], "]"}], "]"}]}], 
      "]"}], ",", 
     RowBox[{"-", "1"}]}], "]"}], "/", 
   RowBox[{"trainSize", "[", 
    RowBox[{"nums", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Count", "[", 
    RowBox[{
     RowBox[{"predData", "[", 
      RowBox[{"w", ",", 
       RowBox[{"(", 
        RowBox[{"vec", "/@", 
         RowBox[{"groupTest", "[", 
          RowBox[{"nums", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}]}], "]"}], ",", 
     "1"}], "]"}], "/", 
   RowBox[{"testSize", "[", 
    RowBox[{"nums", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Count", "[", 
    RowBox[{
     RowBox[{"predData", "[", 
      RowBox[{"w", ",", 
       RowBox[{"(", 
        RowBox[{"vec", "/@", 
         RowBox[{"groupTest", "[", 
          RowBox[{"nums", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ")"}]}], "]"}], ",", 
     RowBox[{"-", "1"}]}], "]"}], "/", 
   RowBox[{"testSize", "[", 
    RowBox[{"nums", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Count", "[", 
    RowBox[{
     RowBox[{"predData", "[", 
      RowBox[{"wSGD", ",", 
       RowBox[{"X", "[", 
        RowBox[{"[", 
         RowBox[{";;", 
          RowBox[{"trainSize", "[", 
           RowBox[{"nums", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "]"}]}], "]"}], ",",
      "1"}], "]"}], "/", 
   RowBox[{"trainSize", "[", 
    RowBox[{"nums", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Count", "[", 
    RowBox[{
     RowBox[{"predData", "[", 
      RowBox[{"wSGD", ",", 
       RowBox[{"X", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"trainSize", "[", 
            RowBox[{"nums", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";;"}], "]"}], "]"}]}], 
      "]"}], ",", 
     RowBox[{"-", "1"}]}], "]"}], "/", 
   RowBox[{"trainSize", "[", 
    RowBox[{"nums", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Count", "[", 
    RowBox[{
     RowBox[{"predData", "[", 
      RowBox[{"wSGD", ",", 
       RowBox[{"(", 
        RowBox[{"vec", "/@", 
         RowBox[{"groupTest", "[", 
          RowBox[{"nums", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}]}], "]"}], ",", 
     "1"}], "]"}], "/", 
   RowBox[{"testSize", "[", 
    RowBox[{"nums", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Count", "[", 
    RowBox[{
     RowBox[{"predData", "[", 
      RowBox[{"wSGD", ",", 
       RowBox[{"(", 
        RowBox[{"vec", "/@", 
         RowBox[{"groupTest", "[", 
          RowBox[{"nums", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ")"}]}], "]"}], ",", 
     RowBox[{"-", "1"}]}], "]"}], "/", 
   RowBox[{"testSize", "[", 
    RowBox[{"nums", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.973867935088073*^9, 3.973867965274271*^9}, {
   3.973880983897625*^9, 3.97388100934597*^9}, {3.9738810647968884`*^9, 
   3.973881076010865*^9}, 3.9745629748320627`*^9, {3.974563388361539*^9, 
   3.9745634147136*^9}, {3.974563553795766*^9, 3.974563577346405*^9}, {
   3.975027612173382*^9, 3.975027627535253*^9}, {3.975080153195744*^9, 
   3.9750801534606657`*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"99b55ea6-d93e-4c59-a026-7dc52e82db11"]
},
WindowSize->{864, 1051},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"14.3 for Mac OS X ARM (64-bit) (July 8, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"739ad3cc-b335-4551-af99-47accaa378ab"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 3951, 105, 258, "Input",ExpressionUUID->"7468b479-d3ca-48fc-b78b-3516419419b2"],
Cell[4508, 127, 925, 25, 49, "Input",ExpressionUUID->"1d4a402a-d9b1-4296-8f4c-ccd3cc8cfc45"],
Cell[5436, 154, 1794, 36, 49, "Input",ExpressionUUID->"419b7ae0-6961-4d2c-9dc8-a51793abd9e5"],
Cell[7233, 192, 2934, 66, 213, "Input",ExpressionUUID->"5924cfd9-ccbd-4875-8cdb-548966507efb"],
Cell[10170, 260, 3584, 96, 294, "Input",ExpressionUUID->"e0292fe9-2f6a-40da-81f9-797833974b28"],
Cell[13757, 358, 266, 4, 49, "Input",ExpressionUUID->"057e89cb-f676-4274-b400-91635157bb9c"],
Cell[14026, 364, 531, 13, 49, "Input",ExpressionUUID->"bb78be62-3a1d-45da-8314-c1aa88996b61"],
Cell[14560, 379, 4547, 135, 172, "Input",ExpressionUUID->"99b55ea6-d93e-4c59-a026-7dc52e82db11"]
}
]
*)

(* End of internal cache information *)

